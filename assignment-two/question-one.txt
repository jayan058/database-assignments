-- Queries:

-- 1. Find all students enrolled in the Math course
SELECT s.student_id, s.student_name
FROM Students s, Enrollments e, Courses c
WHERE s.student_id = e.student_id
AND e.course_id = c.course_id
AND c.course_name = 'Math';

-- 2. List all courses taken by students named Bob
SELECT c.course_id, c.course_name
FROM Students s, Enrollments e, Courses c
WHERE s.student_id = e.student_id
AND e.course_id = c.course_id
AND s.student_name = 'Bob';

-- 3. Find the names of students who are enrolled in more than one course
SELECT s.student_id, s.student_name
FROM Students s, Enrollments e
WHERE s.student_id = e.student_id
GROUP BY s.student_id, s.student_name
HAVING COUNT(e.enrollment_id) > 1;


-- 4. List all students who are in Grade A (grade_id = 1)
SELECT s.student_id, s.student_name
FROM Students s
WHERE s.student_grade_id = 1;

-- 5. Find the number of students enrolled in each course
SELECT c.course_id, c.course_name, COUNT(e.enrollment_id) AS num_students
FROM Courses c, Enrollments e
WHERE c.course_id = e.course_id
GROUP BY c.course_id, c.course_name;

-- 6. Retrieve the course with the highest number of enrollments
SELECT c.course_id, c.course_name, COUNT(e.enrollment_id) AS num_enrollments
FROM Courses c, Enrollments e
WHERE c.course_id = e.course_id
GROUP BY c.course_id, c.course_name
ORDER BY num_enrollments DESC
LIMIT 1;

-- 7. List students who are enrolled in all available courses
SELECT s.student_id, s.student_name
FROM Students s
WHERE NOT EXISTS (
    SELECT *
    FROM Courses c
    WHERE NOT EXISTS (
        SELECT *
        FROM Enrollments e
        WHERE e.student_id = s.student_id AND e.course_id = c.course_id
    )
);

-- 8. Find students who are not enrolled in any courses
SELECT student_id, student_name
FROM Students
WHERE student_id NOT IN (
    SELECT DISTINCT student_id
    FROM Enrollments
);

-- 9. Retrieve the average age of students enrolled in the Science course
SELECT AVG(s.student_age) AS average_age
FROM Students s, Enrollments e, Courses c
WHERE s.student_id = e.student_id
AND e.course_id = c.course_id
AND c.course_name = 'Science';
 
 
-- 10. Find the grade of students enrolled in the History course
SELECT g.grade_name
FROM Grades g, Students s, Enrollments e, Courses c
WHERE g.grade_id = s.student_grade_id
AND s.student_id = e.student_id
AND e.course_id = c.course_id
AND c.course_name = 'History';